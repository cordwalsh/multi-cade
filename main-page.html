<!DOCTYPE html>
<html>
  <head>
    <script
  src="https://code.jquery.com/jquery-3.4.1.js"
  integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
  crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="./main-page.js" charset="utf-8"></script>


    <link href="https://fonts.googleapis.com/css?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <script src="./css/main.css" charset="utf-8"></script>
    <link rel="stylesheet" href="./css/main.css">
    <title>Epic Arcades</title>
  </head>
  <body>


    <!-- ==========================splash page============================================ -->

    <div id="splashform">
      <div id="splash-content">
        <h1 id="splash-h1">EpicArcades</h1>
        <ul id="splash-ul">
          <li id="splash-li">Use the <span class="key key--arrow">&larr;</span> and <span class="key key--arrow">&rarr;</span> keys to change background.</li>
          <li id="splash-li">Use <span class="key">spacebar</span> to game immediately.</li>
        </ul>
      <button id="splash-button" type="submit" class="btn">START</button>
      </div>
    </div>

<!-- ==========================nav bar============================================ -->
      <div class="topnav">
       <a class="active" href="#">Home</a>
       <a href="#">Languages</a>
       <a href="#">Search</a>
       <a href="#">About</a>
      </div>
      <p id="logo">EpicArcades</p>

<!-- =====================main page=========================================== -->

<div id="main-page">
<div class="banner" style="padding:15px; text-align: center;">
  <div class="banner-content">
    <img id="banner-art" src="images/sunset.gif" alt="">
    <div class="banner-text">
      <h1>EpicArcades</h1>
    <p>game tutorials made easy</p>
    <br>
    <h4 id="banner-ready">READY PLAYER 1</h4>
  </div>
</div>
</div>
      <div id="contain" class="container">
        <div class="featured">
        <h3 class="section">Featured</h3>
        <div class="row">
      <div class="col s12 m6">
        <div id='card1' class="card">
          <div class="card-image">
            <img class="still project-image" src="./images/asteroids.png">
            <img id="gif1" class="project-image" src="./images/asteroids.gif">
            <span class="card-title">Asteroids</span>
          </div>
          <div class="card-content">
            <p>A classic game of space survival!</p>
          </div>
          <div class="card-action">
            <a href="#">Play Game</a>
          </div>
        </div>
      </div>
      <div class="col s12 m6">
        <div class="card">
          <div class="card-image">
            <img class="project-image" src="">
            <span class="card-title">Card Title</span>
          </div>
          <div class="card-content">
            <p>I am a very simple card. I am good at containing small bits of information.
            I am convenient because I require little markup to use effectively.</p>
          </div>
          <div class="card-action">
            <a href="#">Play Game</a>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col s12 m6">
        <div class="card">
          <div id="card2" class="card-image">
            <img class="still2 project-image" src="./images/flappy.png">
              <img id="gif2" class="project-image" src="./images/flappy.gif">
            <span class="card-title">Flappy Kirby</span>
          </div>
          <div class="card-content">
            <p>How long can you keep Kirby afloat?</p>
          </div>
          <div class="card-action">
            <a href="#">This is a link</a>
          </div>
        </div>
      </div>
      <div class="col s12 m6">
        <div class="card">
          <div class="card-image">
            <img class="project-image" src="">
            <span class="card-title">Card Title</span>
          </div>
          <div class="card-content">
            <p>I am a very simple card. I am good at containing small bits of information.
            I am convenient because I require little markup to use effectively.</p>
          </div>
          <div class="card-action">
            <a href="#">This is a link</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  </div>
</div>
<!-- =====================================games====================================== -->
<div class="container">
<canvas id="asteroids" width="700" height="500"></canvas>
<canvas id="flappyBird" width="700" height="512"></canvas>
<script src="./asteroids.js" charset="utf-8"></script>
<script src="./flappy-bird.js" charset="utf-8"></script>
</div>
<img id="arcade-background" src="./images/arcade1.jpg" alt="">

<!-- ===================================snake============================================ -->
<script>
  let COLS = 26, ROWS = 26;
  let EMPTY=0, SNAKE=1, FRUITS=2;
  let LEFT=0, UP=1, RIGHT=2, DOWN=3;
  let KEY_LEFT=37, KEY_UP=38, KEY_RIGHT=39, KEY_DOWN=40;

  let grid = {
    width: null,
    height: null,
    _grid: null,

    init: function(d, c, r) {
      this.width = c;
      this.height = r;

      this._grid = [];
      for (let x=0; x < c; x++) {
        this._grid.push([]);
        for (let y=0; y < r; y++) {
          this._grid[x].push(d);
        }
      }
    },

    set: function(val, x, y) {
      this._grid[x][y] = val;
    },

    get: function(x, y) {
      return this._grid[x][y];
    }
  }

  let snake = {
    direction: null,
    last: null,
    _queue: null,

    init: function(d, x, y) {
      this.direction = d;
      this._queue = [];
      this.insert(x, y);
    },

    insert: function(x, y) {
      this._queue.unshift({x:x, y:y});
      this.last = this._queue[0];
    },

    remove: function() {
      return this._queue.pop();
    }
  }

  function setFood() {
    let empty = [];
    for (let x=0; x < grid.width; x++) {
      for (let y=0; y < grid.height; y++) {
        if (grid.get(x, y) === EMPTY) {
          empty.push({x:x, y:y});
        }
      }
    }
    let randpos = empty[Math.floor(Math.random()*empty.length)];
    grid.set(FRUITS, randpos.x, randpos.y);
  }

  let canvas, ctx, keystate, frames, score;

  function main() {
    canvas = document.createElement("canvas");
    canvas.width = COLS*20;
    canvas.height = ROWS*20;
    ctx = canvas.getContext("2d");
    document.body.appendChild(canvas);

    ctx.font = "12px Helvetica";

    frames = 0;
    keystate = {};
    document.addEventListener("keydown", function(evt) {
      keystate[evt.keyCode] = true;
    });
    document.addEventListener("keyup", function(evt) {
      delete keystate[evt.keyCode];
    });

    init();
    loop();
  }

  function init() {
    score = 0;

    grid.init(EMPTY, COLS, ROWS);

    let sp = {x:Math.floor(COLS/2), y:ROWS-1};
    snake.init(UP, sp.x, sp.y);
    grid.set(SNAKE, sp.x, sp.y);
    setFood();
  }

  function loop() {
    update();
    draw();

    window.requestAnimationFrame(loop, canvas);
  }

  function update() {
    frames++;

    if (keystate[KEY_LEFT] && snake.direction !== RIGHT) snake.direction = LEFT;
    if (keystate[KEY_UP] && snake.direction !== DOWN) snake.direction = UP;
    if (keystate[KEY_RIGHT] && snake.direction !== LEFT) snake.direction = RIGHT;
    if (keystate[KEY_DOWN] && snake.direction !== UP) snake.direction = DOWN;

    if (frames%5 === 0) {
      let nx = snake.last.x;
      let ny = snake.last.y;

      switch (snake.direction) {
        case LEFT:
          nx--;
          break;
        case UP:
          ny--;
          break;
        case RIGHT:
          nx++;
          break;
        case DOWN:
          ny++;
          break;
      }

      if (0 > nx || nx > grid.width-1 || 0 > ny || ny > grid.height-1 || grid.get(nx, ny) === SNAKE) {
        return init();
      }

      if (grid.get(nx, ny) === FRUITS) {
        var tail = {x:nx, y:ny};
        score++;
        setFood();
      } else {
        var tail = snake.remove();
        grid.set(EMPTY, tail.x, tail.y);
        tail.x = nx;
        tail.y = ny;
      }

      grid.set(SNAKE, tail.x, tail.y);

      snake.insert(tail.x, tail.y);
    }
  }

  function draw() {
    let tw = canvas.width/grid.width;
    let th = canvas.height/grid.height;

    for (let x=0; x < grid.width; x++) {
      for (let y=0; y < grid.height; y++) {
        switch (grid.get(x, y)) {
          case EMPTY:
            ctx.fillStyle = "#fff";
            break;
          case SNAKE:
            ctx.fillStyle = "#0ff";
            break;
          case FRUITS:
            ctx.fillStyle = "#f00";
            break;
        }
        ctx.fillRect(x*tw, y*th, tw, th);
      }
    }
    ctx.fillStyle = "#000";
    ctx.fillText("SCORE: " + score, 10, canvas.height-10);
  }

  main();
</script>
  </body>
</html>
